apply plugin: 'org.gint.atlassian'

def info = gint.getJiraHelper().getServerInfoWithVerify() // Verify access to Jira instance otherwise end test if server not available
def project = gint.getJiraHelper().getProjectKey()	//get project key using jira helper functions
def workflow =	 project
def workflowScheme =	 project
def baseWorkflow = 'JIRA'

gint.taskHelper.addTearDown(
    action: 'run', name: 'tearDown',
    retry	:[ true ],
    parameters: [
        input: [
            /-a deleteProject         --project ${project}   --continue/,
            /-a deleteWorkflowScheme  --workflowScheme ${workflowScheme} --continue/,
            /-a deleteWorkflow        --workflow ${workflow} --continue/,
            /-a deleteWorkflow        --workflow "Copy of ${project}" --continue/,
            /-a deleteIssueTypeScheme --issueTypeScheme "${project}: Kanban Issue Type Scheme" --continue /,
			/-a deleteIssueTypeScreenScheme --issueTypeScreenScheme "${project}: Kanban Issue Type Screen Scheme" --continue /,
			/-a deleteIssueTypeScreenScheme --issueTypeScreenScheme "${project}: Kanban Issue Type Screen Scheme" --continue /,
			/-a deleteScreenScheme    --screenScheme "${project}: Kanban Bug Screen Scheme" --continue /,
			/-a deleteScreenScheme    --screenScheme "${project}: Kanban Default Screen Scheme" --continue /,
			/-a removeScreen          --screen "${project}: Kanban Bug Screen" --continue/,
			/-a removeScreen          --screen "${project}: Kanban Default Issue Screen" --continue/,
            /-a deleteIssueTypeScheme --issueTypeScheme "${project}: Scrum Issue Type Scheme" --continue /,
			/-a deleteIssueTypeScreenScheme --issueTypeScreenScheme "${project}: Scrum Issue Type Screen Scheme" --continue /,
			/-a deleteIssueTypeScreenScheme --issueTypeScreenScheme "${project}: Scrum Issue Type Screen Scheme" --continue /,
			/-a deleteScreenScheme    --screenScheme "${project}: Scrum Bug Screen Scheme" --continue /,
			/-a deleteScreenScheme    --screenScheme "${project}: Scrum Default Screen Scheme" --continue /,
			/-a removeScreen          --screen "${project}: Scrum Bug Screen" --continue/,
			/-a removeScreen          --screen "${project}: Scrum Default Issue Screen" --continue/,
            /-a copyWorkflow          --workflow "${baseWorkflow}" --name ${workflow}/,
        ],
    ],
)
